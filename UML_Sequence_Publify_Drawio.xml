<mxGraphModel dx="1665" dy="749" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1169" math="0" shadow="0">
  <root>
    <mxCell id="0" />
    <mxCell id="1" parent="0" />
    
    <!-- Titre du diagramme -->
    <mxCell id="titre" value="Diagramme de séquence - Publication multi-réseaux sécurisée - Publify" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="200" y="20" width="800" height="30" as="geometry" />
    </mxCell>
    
    <!-- Acteurs - Lignes de vie -->
    <!-- Utilisateur -->
    <mxCell id="user" value="👤 Utilisateur" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
      <mxGeometry x="50" y="80" width="30" height="60" as="geometry" />
    </mxCell>
    <mxCell id="userLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#9673a6;fillColor=#e1d5e7;" vertex="1" parent="1">
      <mxGeometry x="60" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- Interface Publify -->
    <mxCell id="interface" value="💻 Interface\nPublify" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
      <mxGeometry x="150" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="interfaceLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#6c8ebf;fillColor=#dae8fc;" vertex="1" parent="1">
      <mxGeometry x="185" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- API Publify -->
    <mxCell id="api" value="⚙️ API\nPublify" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
      <mxGeometry x="280" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="apiLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#82b366;fillColor=#d5e8d4;" vertex="1" parent="1">
      <mxGeometry x="315" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- Base de données -->
    <mxCell id="db" value="🗄️ PostgreSQL\nBase données" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
      <mxGeometry x="410" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="dbLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#d6b656;fillColor=#fff2cc;" vertex="1" parent="1">
      <mxGeometry x="445" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- LinkedIn API -->
    <mxCell id="linkedin" value="🔵 LinkedIn\nAPI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0077B5;strokeColor=#ffffff;fontColor=#ffffff;" vertex="1" parent="1">
      <mxGeometry x="540" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="linkedinLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#0077B5;fillColor=#0077B5;" vertex="1" parent="1">
      <mxGeometry x="575" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- Twitter API -->
    <mxCell id="twitter" value="🐦 Twitter\nAPI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1DA1F2;strokeColor=#ffffff;fontColor=#ffffff;" vertex="1" parent="1">
      <mxGeometry x="670" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="twitterLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#1DA1F2;fillColor=#1DA1F2;" vertex="1" parent="1">
      <mxGeometry x="705" y="160" width="10" height="900" as="geometry" />
    </mxCell>
    
    <!-- Facebook API -->
    <mxCell id="facebook" value="📘 Facebook\nAPI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1877F2;strokeColor=#ffffff;fontColor=#ffffff;" vertex="1" parent="1">
      <mxGeometry x="800" y="80" width="80" height="60" as="geometry" />
    </mxCell>
    <mxCell id="facebookLine" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;topToBottom&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};strokeColor=#1877F2;fillColor=#1877F2;" vertex="1" parent="1">
      <mxGeometry x="835" y="160" width="10" height="900" as="geometry" />
    </mxCell>

    <!-- PHASE 1: AUTHENTIFICATION ET VERIFICATION -->
    <mxCell id="phase1" value="PHASE 1: Vérification de l'authentification et des tokens" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFF9C4;strokeColor=#F57F17;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="950" y="180" width="200" height="60" as="geometry" />
    </mxCell>

    <!-- 1. Utilisateur demande création post -->
    <mxCell id="msg1" value="1. Créer nouvelle publication" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=5;strokeColor=#9673a6;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="70" y="190" as="sourcePoint" />
        <mxPoint x="185" y="190" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 2. Interface vers API - vérification session -->
    <mxCell id="msg2" value="2. POST /api/auth/session\n(vérification JWT)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="195" y="210" as="sourcePoint" />
        <mxPoint x="315" y="210" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 3. API vers DB - vérification utilisateur -->
    <mxCell id="msg3" value="3. SELECT id, email FROM utilisateurs\nWHERE id = ? AND statut = 'actif'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="230" as="sourcePoint" />
        <mxPoint x="445" y="230" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 4. Retour utilisateur valide -->
    <mxCell id="msg4" value="4. Utilisateur authentifié ✅" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="250" as="sourcePoint" />
        <mxPoint x="325" y="250" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 5. API récupère les tokens -->
    <mxCell id="msg5" value="5. SELECT reseau_id, access_token, statut\nFROM connexions_reseaux\nWHERE utilisateur_id = ? AND statut = 'actif'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="270" as="sourcePoint" />
        <mxPoint x="445" y="270" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 6. Retour des tokens -->
    <mxCell id="msg6" value="6. Tokens OAuth cryptés 🔐" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="290" as="sourcePoint" />
        <mxPoint x="325" y="290" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 7. Retour vers interface -->
    <mxCell id="msg7" value="7. Réseaux connectés disponibles" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="315" y="310" as="sourcePoint" />
        <mxPoint x="195" y="310" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 8. Affichage pour utilisateur -->
    <mxCell id="msg8" value="8. Formulaire de publication\n(LinkedIn ✅ Twitter ✅ Facebook ✅)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="185" y="330" as="sourcePoint" />
        <mxPoint x="70" y="330" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- PHASE 2: CREATION DU CONTENU -->
    <mxCell id="phase2" value="PHASE 2: Création et sauvegarde du contenu" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#E8F5E8;strokeColor=#4CAF50;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="950" y="370" width="200" height="60" as="geometry" />
    </mxCell>

    <!-- 9. Utilisateur saisit contenu -->
    <mxCell id="msg9" value="9. Saisie contenu + sélection réseaux\n+ upload média (optionnel)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#9673a6;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="70" y="380" as="sourcePoint" />
        <mxPoint x="185" y="380" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 10. Upload média si nécessaire -->
    <mxCell id="msg10" value="10. POST /api/upload\n(si média présent)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="195" y="400" as="sourcePoint" />
        <mxPoint x="315" y="400" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 11. Sauvegarde brouillon -->
    <mxCell id="msg11" value="11. INSERT INTO publications\n(utilisateur_id, contenu, reseaux_cibles, statut='brouillon')" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="420" as="sourcePoint" />
        <mxPoint x="445" y="420" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 12. Confirmation sauvegarde -->
    <mxCell id="msg12" value="12. Publication_ID + Brouillon sauvé ✅" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="440" as="sourcePoint" />
        <mxPoint x="325" y="440" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 13. Confirmation à l'utilisateur -->
    <mxCell id="msg13" value="13. Aperçu publication + Bouton 'Publier'" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="185" y="460" as="sourcePoint" />
        <mxPoint x="70" y="460" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- PHASE 3: PUBLICATION MULTI-RESEAUX -->
    <mxCell id="phase3" value="PHASE 3: Publication sécurisée multi-réseaux" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFE0B2;strokeColor=#FF8F00;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="950" y="500" width="200" height="60" as="geometry" />
    </mxCell>

    <!-- 14. Utilisateur lance publication -->
    <mxCell id="msg14" value="14. Clic 'Publier maintenant'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#9673a6;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="70" y="520" as="sourcePoint" />
        <mxPoint x="185" y="520" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 15. Interface vers API publish -->
    <mxCell id="msg15" value="15. POST /api/publish\n(publication_id, reseaux_cibles)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="195" y="540" as="sourcePoint" />
        <mxPoint x="315" y="540" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- SOUS-SEQUENCE LINKEDIN -->
    <mxCell id="linkedinBox" value="" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;width=120;height=20;fillColor=#E3F2FD;strokeColor=#0077B5;" vertex="1" parent="1">
      <mxGeometry x="300" y="560" width="400" height="120" as="geometry" />
    </mxCell>
    <mxCell id="linkedinLabel" value="Publication LinkedIn" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#0077B5;" vertex="1" parent="1">
      <mxGeometry x="310" y="565" width="100" height="15" as="geometry" />
    </mxCell>

    <!-- 16. Récupération token LinkedIn -->
    <mxCell id="msg16" value="16. SELECT access_token FROM connexions_reseaux\nWHERE utilisateur_id = ? AND reseau_id = 1" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="580" as="sourcePoint" />
        <mxPoint x="445" y="580" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 17. Retour token LinkedIn -->
    <mxCell id="msg17" value="17. Token LinkedIn décrypté 🔐" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="600" as="sourcePoint" />
        <mxPoint x="325" y="600" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 18. Appel API LinkedIn -->
    <mxCell id="msg18" value="18. POST /v2/ugcPosts\nBearer ${access_token}" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#0077B5;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="620" as="sourcePoint" />
        <mxPoint x="575" y="620" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 19. Réponse LinkedIn -->
    <mxCell id="msg19" value="19. Publication LinkedIn réussie ✅\n(post_id: urn:li:share:123456)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#0077B5;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="575" y="640" as="sourcePoint" />
        <mxPoint x="325" y="640" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 20. Mise à jour statut LinkedIn -->
    <mxCell id="msg20" value="20. UPDATE publications\nSET statut_linkedin = 'publie'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="660" as="sourcePoint" />
        <mxPoint x="445" y="660" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- SOUS-SEQUENCE TWITTER -->
    <mxCell id="twitterBox" value="" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;width=120;height=20;fillColor=#E3F8FF;strokeColor=#1DA1F2;" vertex="1" parent="1">
      <mxGeometry x="300" y="690" width="520" height="120" as="geometry" />
    </mxCell>
    <mxCell id="twitterLabel" value="Publication Twitter" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#1DA1F2;" vertex="1" parent="1">
      <mxGeometry x="310" y="695" width="100" height="15" as="geometry" />
    </mxCell>

    <!-- 21-25. Messages Twitter (similaires à LinkedIn) -->
    <mxCell id="msg21" value="21. SELECT access_token FROM connexions_reseaux\nWHERE utilisateur_id = ? AND reseau_id = 2" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="710" as="sourcePoint" />
        <mxPoint x="445" y="710" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg22" value="22. Token Twitter décrypté 🔐" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="730" as="sourcePoint" />
        <mxPoint x="325" y="730" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg23" value="23. POST /2/tweets\nBearer ${access_token}" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#1DA1F2;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="750" as="sourcePoint" />
        <mxPoint x="705" y="750" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg24" value="24. Publication Twitter réussie ✅\n(tweet_id: 123456789)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#1DA1F2;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="705" y="770" as="sourcePoint" />
        <mxPoint x="325" y="770" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg25" value="25. UPDATE publications\nSET statut_twitter = 'publie'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="790" as="sourcePoint" />
        <mxPoint x="445" y="790" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- SOUS-SEQUENCE FACEBOOK -->
    <mxCell id="facebookBox" value="" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;width=120;height=20;fillColor=#EDF7FF;strokeColor=#1877F2;" vertex="1" parent="1">
      <mxGeometry x="300" y="820" width="640" height="120" as="geometry" />
    </mxCell>
    <mxCell id="facebookLabel" value="Publication Facebook" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#1877F2;" vertex="1" parent="1">
      <mxGeometry x="310" y="825" width="100" height="15" as="geometry" />
    </mxCell>

    <!-- 26-30. Messages Facebook (similaires) -->
    <mxCell id="msg26" value="26. SELECT access_token FROM connexions_reseaux\nWHERE utilisateur_id = ? AND reseau_id = 3" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="840" as="sourcePoint" />
        <mxPoint x="445" y="840" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg27" value="27. Token Facebook décrypté 🔐" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#d6b656;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="445" y="860" as="sourcePoint" />
        <mxPoint x="325" y="860" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg28" value="28. POST /me/feed\naccess_token=${token}" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#1877F2;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="880" as="sourcePoint" />
        <mxPoint x="835" y="880" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg29" value="29. Publication Facebook réussie ✅\n(post_id: 123456_789)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#1877F2;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="835" y="900" as="sourcePoint" />
        <mxPoint x="325" y="900" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <mxCell id="msg30" value="30. UPDATE publications\nSET statut_facebook = 'publie'" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="920" as="sourcePoint" />
        <mxPoint x="445" y="920" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- PHASE 4: CONSOLIDATION -->
    <mxCell id="phase4" value="PHASE 4: Audit et retour utilisateur" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#F3E5F5;strokeColor=#9C27B0;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="950" y="950" width="200" height="60" as="geometry" />
    </mxCell>

    <!-- 31. Audit log -->
    <mxCell id="msg31" value="31. INSERT INTO audit_log\n(action: 'publication_multi_reseaux', utilisateur_id, details)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="960" as="sourcePoint" />
        <mxPoint x="445" y="960" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 32. Mise à jour métriques -->
    <mxCell id="msg32" value="32. INSERT INTO metriques_performance\n(publication_id, réseau, statut, post_id_externe)" style="html=1;verticalAlign=bottom;endArrow=block;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="325" y="980" as="sourcePoint" />
        <mxPoint x="445" y="980" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 33. Retour vers interface -->
    <mxCell id="msg33" value="33. Statut global publication\n(LinkedIn ✅ Twitter ✅ Facebook ✅)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#82b366;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="315" y="1000" as="sourcePoint" />
        <mxPoint x="195" y="1000" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- 34. Notification utilisateur -->
    <mxCell id="msg34" value="34. 🎉 Publication réussie sur tous les réseaux !\n(Voir analytics en temps réel)" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;curved=0;rounded=0;strokeColor=#6c8ebf;" edge="1" parent="1">
      <mxGeometry relative="1" as="geometry">
        <mxPoint x="185" y="1020" as="sourcePoint" />
        <mxPoint x="70" y="1020" as="targetPoint" />
      </mxGeometry>
    </mxCell>

    <!-- Légende sécurité -->
    <mxCell id="security" value="🔐 SÉCURITÉ CCP 2:\n• Tokens OAuth cryptés (pas de mots de passe)\n• Isolation par utilisateur (WHERE utilisateur_id = ?)\n• Audit complet des actions\n• Gestion d'erreurs par réseau\n• Sessions JWT sécurisées" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fontColor=#000000;darkOpacity=0.05;fillColor=#FFEBEE;strokeColor=#F44336;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="950" y="1070" width="250" height="120" as="geometry" />
    </mxCell>

  </root>
</mxGraphModel>